window.LivewireUIModal=()=>({show:!1,showActiveComponent:!0,activeComponent:!1,componentHistory:[],modalWidth:null,listeners:[],init(){this.modalWidth=this.getActiveComponentModalAttribute("maxWidthClass"),this.setupEventListeners()},setupEventListeners(){this.listeners.push(Livewire.on("closeModal",e=>{this.closeModal((e==null?void 0:e.force)??!1,(e==null?void 0:e.skipPreviousModals)??0,(e==null?void 0:e.destroySkipped)??!1)})),this.listeners.push(Livewire.on("activeModalComponentChanged",({id:e})=>{this.setActiveModalComponent(e)}))},destroy(){this.listeners.forEach(e=>{e()})},getActiveComponentModalAttribute(e){if(this.$wire.get("components")[this.activeComponent]!==void 0)return this.$wire.get("components")[this.activeComponent].modalAttributes[e]},closeModalOnEscape(){if(this.getActiveComponentModalAttribute("closeOnEscape")===!1||!this.closingModal("closingModalOnEscape"))return;let e=this.getActiveComponentModalAttribute("closeOnEscapeIsForceful")===!0;this.closeModal(e)},closeModalOnClickAway(){this.getActiveComponentModalAttribute("closeOnClickAway")!==!1&&this.closingModal("closingModalOnClickAway")&&this.closeModal(!0)},closingModal(e){const t=this.$wire.get("components")[this.activeComponent].name;var o={id:this.activeComponent,closing:!0};return Livewire.dispatchTo(t,e,o),o.closing},closeModal(e=!1,t=0,o=!1){this.show!==!1&&(this.handleCloseEvents(),this.handleSkippedModals(t,o),this.handleModalClosure(e))},handleCloseEvents(){if(this.getActiveComponentModalAttribute("dispatchCloseEvent")===!0){const e=this.$wire.get("components")[this.activeComponent].name;Livewire.dispatch("modalClosed",{name:e})}this.getActiveComponentModalAttribute("destroyOnClose")===!0&&Livewire.dispatch("destroyComponent",{id:this.activeComponent})},handleSkippedModals(e,t){if(e>0)for(var o=0;o<e;o++){if(t){const s=this.componentHistory[this.componentHistory.length-1];Livewire.dispatch("destroyComponent",{id:s})}this.componentHistory.pop()}},handleModalClosure(e){const t=this.componentHistory.pop();t&&!e?t?this.setActiveModalComponent(t,!0):this.setShowPropertyTo(!1):this.setShowPropertyTo(!1)},setActiveModalComponent(e,t=!1){this.setShowPropertyTo(!0),this.activeComponent!==e&&(this.activeComponent!==!1&&t===!1&&this.componentHistory.push(this.activeComponent),this.updateActiveComponent(e))},updateActiveComponent(e){let t=50;this.activeComponent===!1?(this.activeComponent=e,this.showActiveComponent=!0,this.modalWidth=this.getActiveComponentModalAttribute("maxWidthClass")):(this.showActiveComponent=!1,t=400,setTimeout(()=>{this.activeComponent=e,this.showActiveComponent=!0,this.modalWidth=this.getActiveComponentModalAttribute("maxWidthClass")},300)),this.setFocus(e,t)},setFocus(e,t){this.$nextTick(()=>{var s;let o=(s=this.$refs[e])==null?void 0:s.querySelector("[autofocus]");o&&setTimeout(()=>{o.focus()},t)})},focusables(){return[...this.$el.querySelectorAll("a, button, input:not([type='hidden']), textarea, select, details, [tabindex]:not([tabindex='-1'])")].filter(t=>!t.hasAttribute("disabled"))},firstFocusable(){return this.focusables()[0]},lastFocusable(){return this.focusables().slice(-1)[0]},nextFocusable(){return this.focusables()[this.nextFocusableIndex()]||this.firstFocusable()},prevFocusable(){return this.focusables()[this.prevFocusableIndex()]||this.lastFocusable()},nextFocusableIndex(){return(this.focusables().indexOf(document.activeElement)+1)%(this.focusables().length+1)},prevFocusableIndex(){return Math.max(0,this.focusables().indexOf(document.activeElement))-1},setShowPropertyTo(e){this.show=e,e?document.body.classList.add("overflow-y-hidden"):(document.body.classList.remove("overflow-y-hidden"),setTimeout(()=>{this.activeComponent=!1,this.$wire.resetState()},300))}});
